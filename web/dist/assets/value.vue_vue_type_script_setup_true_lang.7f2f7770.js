import"./index.93ba0c34.js";/* empty css              *//* empty css               *//* empty css               */import{d as C,e as s,w as F,bm as k,bf as E,aC as m,aI as u,aP as B,A as i,aJ as p,B as D,aK as S,aN as N,bn as x}from"./arco.9b5dfa89.js";import{C as J}from"./index.2ea1f45a.js";const M=C({__name:"value",props:{values:null,envs:null},emits:["update"],setup(d,{expose:w,emit:_}){const f=d,c=s(),n=s(!1),r=s({}),v=s({});F(()=>f.values,t=>{!t||(r.value={},t.forEach(e=>{r.value[e.environment_id]=e.values}),v.value={...r.value})}),w({showUpdateDrawer:()=>{n.value=!0},closeDrawer:()=>{n.value=!1}});const h=async()=>{if(await c.value.validate())return!1;const e=[];try{f.envs.forEach(o=>{const l=JSON.stringify(JSON.parse(r.value[o.id]));e.push({env_keyword:o.keyword,environment_id:o.id,values:JSON.stringify(JSON.parse(l))})})}catch{return B.error("\u6570\u636E\u683C\u5F0F\u5B58\u5728\u9519\u8BEF"),!1}return _("update",[...e]),!0},g=(t,e)=>{r.value[e]=t};return(t,e)=>{const o=x,l=k,b=E;return i(),m(b,{visible:n.value,"onUpdate:visible":e[0]||(e[0]=a=>n.value=a),title:"\u53D8\u91CF\u503C\u914D\u7F6E",width:"380px",onCancel:e[1]||(e[1]=a=>n.value=!1),onBeforeOk:h},{default:u(()=>[p(l,{ref_key:"formRef",ref:c,model:r.value,"label-align":"left",layout:"vertical","auto-label-width":""},{default:u(()=>[(i(!0),D(N,null,S(d.envs,(a,y)=>(i(),m(o,{key:y,field:String(a.id),label:a.name+"("+a.keyword+")",rules:[{required:!0,message:a.name+"("+a.keyword+")\u914D\u7F6E\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:u(()=>[p(J,{id:String(a.id),value:v.value[a.id],style:{width:"100%",height:"150px"},"show-folding":!1,"show-line":!1,onChange:g},null,8,["id","value"])]),_:2},1032,["field","label","rules"]))),128))]),_:1},8,["model"])]),_:1},8,["visible"])}}});export{M as _};
