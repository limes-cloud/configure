import{n as T,t as H,v as Q,_ as W}from"./index.57c7a0a0.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{d as X,e as l,w as Y,aV as Z,T as ee,bk as te,bm as ue,by as oe,B as D,E as p,bc as f,aC as _,aI as u,aJ as o,aP as ne,aG as le,A as s,aL as y,aN as $,aK as N,aM as I,bn as ae,bA as re,bt as se}from"./arco.9b5dfa89.js";import{C as U}from"./index.009711f5.js";function De(a){return T.get("/configure/v1/template/current",{params:{server_id:a}})}function Te(a){return T.post("/configure/v1/template",a)}function ie(a){return T.post(`/configure/v1/template/preview/${a.env_keyword}`,a)}const de={class:"configure"},ve={class:"header"},me={class:"header-item"},ce={class:"header-item"},pe={class:"header-item"},fe={class:"edit"},_e=X({__name:"center",props:{template:null,envs:null},emits:["submit","sync"],setup(a,{emit:A}){const i=a,R=l(),F=l(!1),b=l(!1),J=l(),O=l(),j=l(),d=l({}),v=l({}),n=l({description:"",content:"",format:"json"}),m=l(!1),k=l(""),g=l(!1),M=async()=>{if(await O.value.validate())return!1;try{n.value.content=JSON.stringify(JSON.parse(n.value.content))}catch{return ne.error("\u914D\u7F6E\u683C\u5F0F\u9519\u8BEF"),!1}return A("submit",n.value),!0},q=async()=>{var e;const{data:r}=await ie({env_keyword:d.value.env_keyword,content:n.value.content,format:n.value.format,server_id:(e=i.template)==null?void 0:e.server_id});n.value.format==="json"?k.value=JSON.stringify(JSON.parse(r.content),null,3):k.value=r.content,m.value=!0},L=()=>{var r;return A("sync",{server_id:(r=i.template)==null?void 0:r.server_id,env_keyword:v.value.env_keyword,description:"\u4FEE\u6539\u914D\u7F6E"}),!0};return Y(()=>i.template,r=>{r&&(n.value.content=r.content)},{deep:!0}),(r,e)=>{var S;const P=H,B=Z,z=ee,G=Q,K=te,E=ae,C=ue,w=le,h=re,x=oe,c=se("permission");return s(),D("div",de,[p("div",ve,[p("div",me,[f((s(),_(B,{type:"primary",status:"success",disabled:!i.template,onClick:e[0]||(e[0]=t=>(b.value=!0,d.value.env_keyword=void 0))},{icon:u(()=>[o(P)]),default:u(()=>[y("\u751F\u6210\u9884\u89C8 ")]),_:1},8,["disabled"])),[[c,"configure:template:preview"]])]),p("div",ce,[f((s(),_(B,{type:"primary",disabled:!i.template,onClick:e[1]||(e[1]=t=>(F.value=!0,n.value.description=""))},{icon:u(()=>[o(z)]),default:u(()=>[y("\u63D0\u4EA4\u6A21\u677F ")]),_:1},8,["disabled"])),[[c,"configure:template:add"]])]),p("div",pe,[f((s(),_(B,{type:"primary",disabled:!i.template,onClick:e[2]||(e[2]=t=>(g.value=!0,v.value.env_keyword=void 0))},{icon:u(()=>[o(G)]),default:u(()=>[y("\u540C\u6B65\u914D\u7F6E ")]),_:1},8,["disabled"])),[[c,"configure:configure:sync"]])])]),p("div",fe,[o(U,{ref_key:"coder",ref:R,value:(S=a.template)==null?void 0:S.content,lang:n.value.format,"show-line":!1,style:{width:"100%",height:"100%"},theme:"BlackTheme",onChange:e[3]||(e[3]=t=>{n.value.content=t})},null,8,["value","lang"])]),o(w,{visible:F.value,"onUpdate:visible":e[5]||(e[5]=t=>F.value=t),simple:"",title:"\u914D\u7F6E\u6A21\u677F\u63D0\u4EA4",onCancel:e[6]||(e[6]=t=>F.value=!1),onBeforeOk:M},{default:u(()=>[o(C,{ref_key:"submitFormRef",ref:O,model:n.value,layout:"vertical"},{default:u(()=>[o(E,{field:"description",label:"\u8BF7\u7B80\u8981\u6982\u8FF0\u4E00\u4E0B\u672C\u6B21\u63D0\u4EA4\u7684\u4FEE\u6539",rules:[{required:!0,message:"\u6A21\u677F\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:u(()=>[o(K,{modelValue:n.value.description,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.description=t),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),o(w,{visible:b.value,"onUpdate:visible":e[8]||(e[8]=t=>b.value=t),simple:"",title:"\u6E32\u67D3\u9884\u89C8",onCancel:e[9]||(e[9]=t=>b.value=!1),onBeforeOk:q},{default:u(()=>[o(C,{ref_key:"previewFormRef",ref:J,model:d.value,layout:"vertical"},{default:u(()=>[o(E,{field:"env_keyword",label:"\u8BF7\u9009\u62E9\u9700\u8981\u6E32\u67D3\u7684\u73AF\u5883",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9700\u8981\u6E32\u67D3\u7684\u73AF\u5883"}],"validate-trigger":["change","input"]},{default:u(()=>[o(x,{modelValue:d.value.env_keyword,"onUpdate:modelValue":e[7]||(e[7]=t=>d.value.env_keyword=t),"allow-search":"",placeholder:"\u8BF7\u9009\u62E9"},{default:u(()=>[(s(!0),D($,null,N(a.envs,(t,V)=>f((s(),_(h,{key:V,value:t.keyword},{default:u(()=>[y(I(t.name),1)]),_:2},1032,["value"])),[[c,"configure:template:preview:"+t.keyword]])),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),o(w,{visible:g.value,"onUpdate:visible":e[11]||(e[11]=t=>g.value=t),simple:"",title:"\u540C\u6B65\u914D\u7F6E",onCancel:e[12]||(e[12]=t=>g.value=!1),onBeforeOk:L},{default:u(()=>[o(C,{ref_key:"syncFormRef",ref:j,model:v.value,layout:"vertical"},{default:u(()=>[o(E,{field:"env_keyword",label:"\u8BF7\u9009\u62E9\u9700\u8981\u540C\u6B65\u7684\u73AF\u5883",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9700\u8981\u540C\u6B65\u7684\u73AF\u5883"}],"validate-trigger":["change","input"]},{default:u(()=>[o(x,{modelValue:v.value.env_keyword,"onUpdate:modelValue":e[10]||(e[10]=t=>v.value.env_keyword=t),"allow-search":"",placeholder:"\u8BF7\u9009\u62E9"},{default:u(()=>[(s(!0),D($,null,N(a.envs,(t,V)=>f((s(),_(h,{key:V,value:t.keyword},{default:u(()=>[y(I(t.name),1)]),_:2},1032,["value"])),[[c,"configure:configure:sync:"+t.keyword]])),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),o(w,{visible:m.value,"onUpdate:visible":e[13]||(e[13]=t=>m.value=t),title:"\u914D\u7F6E\u8BE6\u60C5",width:"700px","body-style":{height:"400px",padding:"0"},onCancel:e[14]||(e[14]=t=>m.value=!1),onBeforeOk:e[15]||(e[15]=t=>m.value=!1)},{default:u(()=>[o(U,{value:k.value,lang:n.value.format,"show-line":!1,"read-only":!0,style:{width:"100%",height:"100%"},theme:"BlackTheme"},null,8,["value","lang"])]),_:1},8,["visible"])])}}});const ye=W(_e,[["__scopeId","data-v-52eef5f2"]]),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{ye as C,Te as a,Ae as b,De as c};
