import{aE as c,d as V,E as a,aF as G,e as $,g as u,w as j,o as M,M as i,ab as P}from"./index.b4c32530.js";/* empty css              *//* empty css               */import{u as q}from"./loading.1cfe06b8.js";import{a as H}from"./resource-server.7b0d7086.js";import{a as J}from"./env.aed42338.js";import K from"./tool.71cad458.js";import{_ as O}from"./table.vue_vue_type_script_setup_true_lang.7635ff17.js";import{_ as Q}from"./form.vue_vue_type_script_setup_true_lang.6d8d75d8.js";import{_ as W}from"./search.vue_vue_type_script_setup_true_lang.9c5716cc.js";import{_ as X}from"./value.vue_vue_type_script_setup_true_lang.6f771609.js";/* empty css               *//* empty css              *//* empty css               */import"./lodash.56658418.js";import"./sortable.esm.41bdaeb5.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css                */import"./server.c484d62d.js";function Y(t){return c.get("/configure/v1/resources",{params:{...t}})}function Z(t){return c.post("/configure/v1/resource",t)}function ee(t){return c.put("/configure/v1/resource",t)}function ae(t){return c.delete("/configure/v1/resource",{params:{id:t}})}function te(t){return c.get("/configure/v1/resource/values",{params:{resource_id:t}})}function se(t,r){return c.put("/configure/v1/resource/value",{resource_id:t,list:r})}const oe={class:"container"},ne={name:"ConfigureResource"},Ee=V({...ne,setup(t){const r=a(),v=a(),l=a({}),{setLoading:f}=q(!0),R=a(!1),g=a(),_=a([]),d=a("medium"),F=a(0),h=a([]),w=a([]),y=a(0),o=a({page:1,page_size:10}),p=a([{title:"\u53D8\u91CF\u6807\u5FD7",dataIndex:"keyword",slotName:"keyword"},{title:"\u53D8\u91CF\u5B57\u6BB5",dataIndex:"fields",slotName:"fields"},{title:"\u53D8\u91CF\u6807\u7B7E",dataIndex:"tag",slotName:"tag"},{title:"\u53D8\u91CF\u63CF\u8FF0",dataIndex:"description",slotName:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",slotName:"createdAt"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updated_at",slotName:"updatedAt"},{title:"\u64CD\u4F5C",dataIndex:"operations",slotName:"operations"}]),z=async()=>{const{data:e}=await J();h.value=e.list},C=async e=>{const{data:s}=await te(e);w.value=s},D=async e=>{const{data:s}=await H(e);_.value=s.list},n=async()=>{f(!0);try{const{data:e}=await Y(o.value);g.value=e.list,F.value=e.total}finally{f(!1)}};n(),z();const A=async e=>{e.fields=e.fieldList.join(","),await Z(e),n(),i.success("\u521B\u5EFA\u6210\u529F")},B=async e=>{e.fields=e.fieldList.join(","),await ee(e),n(),i.success("\u66F4\u65B0\u6210\u529F")},x=async e=>{await ae(e),n(),i.success("\u5220\u9664\u6210\u529F")},U=async e=>{const s=o.value.page_size;o.value={...e,page:1,page_size:s},n()},E=async e=>{await se(y.value,e),i.success("\u914D\u7F6E\u6210\u529F")},S=()=>{l.value={},r.value.showAddDrawer()},N=e=>{D(e.id),l.value={...e},l.value.fieldList=l.value.fields.split(","),r.value.showUpdateDrawer()},b=e=>{l.value={},r.value.showAddDrawer()},I=e=>{y.value=e,C(e),v.value.showUpdateDrawer()},k=async e=>{o.value.page=e.current,o.value.page_size=e.pageSize,n()};return(e,s)=>{const L=P("Breadcrumb"),T=G;return M(),$("div",oe,[u(L),u(T,{class:"general-card"},{default:j(()=>[u(W,{onSearch:U}),u(K,{size:d.value,"onUpdate:size":s[0]||(s[0]=m=>d.value=m),columns:p.value,"onUpdate:columns":s[1]||(s[1]=m=>p.value=m),onRefresh:n,onAdd:S},null,8,["size","columns"]),u(O,{columns:p.value,loading:R.value,data:g.value,size:d.value,total:F.value,pagination:{current:o.value.page,pageSize:o.value.page_size},onPageChange:k,onAdd:b,onUpdate:N,onDelete:x,onSet:I},null,8,["columns","loading","data","size","total","pagination"]),u(Q,{ref_key:"formRef",ref:r,data:l.value,servers:_.value,onAdd:A,onUpdate:B},null,8,["data","servers"]),u(X,{ref_key:"valueRef",ref:v,values:w.value,envs:h.value,onUpdate:E},null,8,["values","envs"])]),_:1})])}}});export{Ee as default};
