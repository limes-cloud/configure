import{aC as T,d as K,E as l,$ as Q,b2 as W,B as X,b3 as Y,b4 as Z,aw as ee,az as te,aS as ue,e as D,f as c,ac as f,k as _,w as u,g as n,a_ as oe,o as r,h as y,a2 as U,a3 as N,t as I,aA as ne,aU as ae,aL as le,_ as se}from"./index.16e62b85.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{C as R}from"./index.491d0914.js";function Ce(s){return T.get("/configure/v1/template/current",{params:{server_id:s}})}function Ve(s){return T.post("/configure/v1/template",s)}function re(s){return T.post(`/configure/v1/template/preview/${s.env_keyword}`,s)}const ie={class:"configure"},de={class:"header"},ve={class:"header-item"},me={class:"header-item"},pe={class:"header-item"},ce={class:"edit"},fe=K({__name:"center",props:{template:null,envs:null},emits:["submit","sync"],setup(s,{emit:A}){const i=s,O=l(),g=l(!1),F=l(!1),j=l(),S=l(),J=l(),d=l({}),v=l({}),o=l({description:"",content:"",format:"json"}),m=l(!1),b=l(""),w=l(!1),L=async()=>await S.value.validate()?!1:(o.value.format==="json"?o.value.content=JSON.stringify(JSON.parse(o.value.content)):b.value=o.value.content,A("submit",o.value),!0),q=async()=>{var e;const{data:a}=await re({env_keyword:d.value.env_keyword,content:o.value.content,format:o.value.format,server_id:(e=i.template)==null?void 0:e.server_id});o.value.format==="json"?b.value=JSON.stringify(JSON.parse(a.content),null,3):b.value=a.content,m.value=!0},z=()=>{var a;return A("sync",{server_id:(a=i.template)==null?void 0:a.server_id,env_keyword:v.value.env_keyword,description:"\u4FEE\u6539\u914D\u7F6E"}),!0};return Q(()=>i.template,a=>{!a||(o.value.content=a.content,o.value.format=a.format,O.value.setEditLang(a.format))},{deep:!0}),(a,e)=>{var x;const M=W,B=X,P=Y,G=Z,H=ee,E=ne,C=te,k=oe,$=ae,h=ue,p=le("permission");return r(),D("div",ie,[c("div",de,[c("div",ve,[f((r(),_(B,{type:"primary",status:"success",disabled:!i.template,onClick:e[0]||(e[0]=t=>(F.value=!0,d.value.env_keyword=void 0))},{icon:u(()=>[n(M)]),default:u(()=>[y(" \u751F\u6210\u9884\u89C8 ")]),_:1},8,["disabled"])),[[p,"configure:template:preview"]])]),c("div",me,[f((r(),_(B,{type:"primary",disabled:!i.template,onClick:e[1]||(e[1]=t=>(g.value=!0,o.value.description=""))},{icon:u(()=>[n(P)]),default:u(()=>[y(" \u63D0\u4EA4\u6A21\u677F ")]),_:1},8,["disabled"])),[[p,"configure:template:add"]])]),c("div",pe,[f((r(),_(B,{type:"primary",disabled:!i.template,onClick:e[2]||(e[2]=t=>(w.value=!0,v.value.env_keyword=void 0))},{icon:u(()=>[n(G)]),default:u(()=>[y(" \u540C\u6B65\u914D\u7F6E ")]),_:1},8,["disabled"])),[[p,"configure:configure:sync"]])])]),c("div",ce,[n(R,{ref_key:"coder",ref:O,value:(x=s.template)==null?void 0:x.content,lang:o.value.format,"show-line":!1,"switch-lang":!0,style:{width:"100%",height:"100%"},theme:"BlackTheme",onChange:e[3]||(e[3]=t=>{o.value.content=t}),onChangeLang:e[4]||(e[4]=t=>{o.value.format=t})},null,8,["value","lang"])]),n(k,{visible:g.value,"onUpdate:visible":e[6]||(e[6]=t=>g.value=t),simple:"",title:"\u914D\u7F6E\u6A21\u677F\u63D0\u4EA4",onCancel:e[7]||(e[7]=t=>g.value=!1),onBeforeOk:L},{default:u(()=>[n(C,{ref_key:"submitFormRef",ref:S,model:o.value,layout:"vertical"},{default:u(()=>[n(E,{field:"description",label:"\u8BF7\u7B80\u8981\u6982\u8FF0\u4E00\u4E0B\u672C\u6B21\u63D0\u4EA4\u7684\u4FEE\u6539",rules:[{required:!0,message:"\u6A21\u677F\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:u(()=>[n(H,{modelValue:o.value.description,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.description=t),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),n(k,{visible:F.value,"onUpdate:visible":e[9]||(e[9]=t=>F.value=t),simple:"",title:"\u6E32\u67D3\u9884\u89C8",onCancel:e[10]||(e[10]=t=>F.value=!1),onBeforeOk:q},{default:u(()=>[n(C,{ref_key:"previewFormRef",ref:j,model:d.value,layout:"vertical"},{default:u(()=>[n(E,{field:"env_keyword",label:"\u8BF7\u9009\u62E9\u9700\u8981\u6E32\u67D3\u7684\u73AF\u5883",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9700\u8981\u6E32\u67D3\u7684\u73AF\u5883"}],"validate-trigger":["change","input"]},{default:u(()=>[n(h,{modelValue:d.value.env_keyword,"onUpdate:modelValue":e[8]||(e[8]=t=>d.value.env_keyword=t),"allow-search":"",placeholder:"\u8BF7\u9009\u62E9"},{default:u(()=>[(r(!0),D(U,null,N(s.envs,(t,V)=>f((r(),_($,{key:V,value:t.keyword},{default:u(()=>[y(I(t.name),1)]),_:2},1032,["value"])),[[p,"configure:template:preview:"+t.keyword]])),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),n(k,{visible:w.value,"onUpdate:visible":e[12]||(e[12]=t=>w.value=t),simple:"",title:"\u540C\u6B65\u914D\u7F6E",onCancel:e[13]||(e[13]=t=>w.value=!1),onBeforeOk:z},{default:u(()=>[n(C,{ref_key:"syncFormRef",ref:J,model:v.value,layout:"vertical"},{default:u(()=>[n(E,{field:"env_keyword",label:"\u8BF7\u9009\u62E9\u9700\u8981\u540C\u6B65\u7684\u73AF\u5883",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9700\u8981\u540C\u6B65\u7684\u73AF\u5883"}],"validate-trigger":["change","input"]},{default:u(()=>[n(h,{modelValue:v.value.env_keyword,"onUpdate:modelValue":e[11]||(e[11]=t=>v.value.env_keyword=t),"allow-search":"",placeholder:"\u8BF7\u9009\u62E9"},{default:u(()=>[(r(!0),D(U,null,N(s.envs,(t,V)=>f((r(),_($,{key:V,value:t.keyword},{default:u(()=>[y(I(t.name),1)]),_:2},1032,["value"])),[[p,"configure:configure:sync:"+t.keyword]])),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),n(k,{visible:m.value,"onUpdate:visible":e[14]||(e[14]=t=>m.value=t),title:"\u914D\u7F6E\u8BE6\u60C5",width:"700px","body-style":{height:"400px",padding:"0"},onCancel:e[15]||(e[15]=t=>m.value=!1),onBeforeOk:e[16]||(e[16]=t=>m.value=!1)},{default:u(()=>[n(R,{value:b.value,lang:o.value.format,"show-line":!1,"read-only":!0,style:{width:"100%",height:"100%"},theme:"BlackTheme"},null,8,["value","lang"])]),_:1},8,["visible"])])}}});const _e=se(fe,[["__scopeId","data-v-84422274"]]),De=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"}));export{_e as C,Ve as a,De as b,Ce as c};
