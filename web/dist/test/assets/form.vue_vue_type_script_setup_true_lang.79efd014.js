import{d as x,E as v,$ as C,aw as A,b2 as q,b0 as $,aU as S,aV as R,az as z,af as I,k as g,w as t,o as B,g as l,h as _,l as L,aA as N,b1 as T}from"./index.e1248d42.js";/* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               */import{p as G}from"./server.c206e384.js";const Y=x({__name:"form",props:{data:null,servers:null},emits:["add","update"],setup(w,{expose:D,emit:c}){const f=w,F=v(),d=v(!1),n=v(!1),p=v([]),e=v({...f.data});C(()=>f.data,s=>{e.value=s},{deep:!0}),C(()=>f.servers,s=>{s.forEach(u=>{e.value.servers||(e.value.servers=[]),u.name=`${u.name}(${u.keyword})`,p.value.push(u),e.value.servers.push(u.id)})}),D({showAddDrawer:()=>{d.value=!0,n.value=!0},showUpdateDrawer:()=>{d.value=!0,n.value=!1},closeDrawer:()=>{d.value=!1}});const V=async()=>await F.value.validate()?!1:(n.value?c("add",{...e.value}):c("update",{...e.value}),!0),b=async s=>{const{data:u}=await G({page:1,page_size:10,keyword:s}),{list:i}=u;if(!i)return;e.value.servers||(e.value.servers=[]);const o=[];i.forEach(r=>{e.value.servers.includes(r.id)||(r.name=`${r.name}(${r.keyword})`,o.push(r))});const m=[];p.value.forEach(r=>{e.value.servers.includes(r.id)&&m.push(r)}),p.value=o.concat(m)};return(s,u)=>{const i=A,o=N,m=q,r=$,h=T,E=S,k=R,y=z,U=I;return B(),g(U,{visible:d.value,"onUpdate:visible":u[6]||(u[6]=a=>d.value=a),title:n.value?"\u65B0\u5EFA":"\u4FEE\u6539",width:"380px",onCancel:u[7]||(u[7]=a=>d.value=!1),onBeforeOk:V},{default:t(()=>[l(y,{ref_key:"formRef",ref:F,model:e.value,"label-align":"left",layout:"horizontal","auto-label-width":""},{default:t(()=>[l(o,{field:"keyword",label:"\u53D8\u91CF\u6807\u8BC6",rules:[{required:!0,message:"\u53D8\u91CF\u6807\u8BC6\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(i,{modelValue:e.value.keyword,"onUpdate:modelValue":u[0]||(u[0]=a=>e.value.keyword=a),disabled:!n.value,placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u6807\u8BC6","allow-clear":""},null,8,["modelValue","disabled"])]),_:1}),l(o,{field:"tag",label:"\u53D8\u91CF\u6807\u7B7E",rules:[{required:!0,message:"\u53D8\u91CF\u6807\u7B7E\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(i,{modelValue:e.value.tag,"onUpdate:modelValue":u[1]||(u[1]=a=>e.value.tag=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u6807\u7B7E","allow-clear":""},null,8,["modelValue"])]),_:1}),l(o,{field:"fieldList",label:"\u53D8\u91CF\u5B57\u6BB5",rules:[{required:!0,message:"\u53D8\u91CF\u5B57\u6BB5\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(m,{modelValue:e.value.fieldList,"onUpdate:modelValue":u[2]||(u[2]=a=>e.value.fieldList=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u5B57\u6BB5","unique-value":"","allow-clear":""},null,8,["modelValue"])]),_:1}),l(o,{field:"private",label:"\u53D8\u91CF\u7C7B\u578B",rules:[{required:!0,message:"\u53D8\u91CF\u7C7B\u578B\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(h,{modelValue:e.value.private,"onUpdate:modelValue":u[3]||(u[3]=a=>e.value.private=a)},{default:t(()=>[l(r,{value:!0},{default:t(()=>[_("\u79C1\u6709\u53D8\u91CF")]),_:1}),l(r,{value:!1},{default:t(()=>[_("\u516C\u5171\u53D8\u91CF")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.value.private?(B(),g(o,{key:0,field:"private",label:"\u6240\u5C5E\u670D\u52A1",rules:[{required:!0,message:"\u6240\u5C5E\u670D\u52A1\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(E,{modelValue:e.value.servers,"onUpdate:modelValue":u[4]||(u[4]=a=>e.value.servers=a),placeholder:"\u8BF7\u9009\u62E9\u53D8\u91CF\u6240\u5C5E\u670D\u52A1",multiple:"","max-tag-count":2,scrollbar:!0,options:p.value,"allow-search":"","field-names":{value:"id",label:"name"},onSearch:b},null,8,["modelValue","options"])]),_:1})):L("",!0),l(o,{field:"description",label:"\u53D8\u91CF\u63CF\u8FF0",rules:[{required:!0,message:"\u53D8\u91CF\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(k,{modelValue:e.value.description,"onUpdate:modelValue":u[5]||(u[5]=a=>e.value.description=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{Y as _};
