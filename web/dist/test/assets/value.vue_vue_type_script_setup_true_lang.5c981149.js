import{d as k,E as l,$ as C,az as E,af as b,k as m,w as u,M as D,o as i,g as p,e as B,a3 as S,a2 as x,aA as N}from"./index.1e297ea4.js";/* empty css              *//* empty css               *//* empty css               */import{C as O}from"./index.f8d0965c.js";const A=k({__name:"value",props:{values:null,envs:null},emits:["update"],setup(d,{expose:w,emit:_}){const f=d,c=l(),s=l(!1),r=l({}),v=l({});C(()=>f.values,o=>{!o||(r.value={},o.forEach(e=>{r.value[e.environment_id]=e.values}),v.value={...r.value})}),w({showUpdateDrawer:()=>{s.value=!0},closeDrawer:()=>{s.value=!1}});const g=async()=>{if(await c.value.validate())return!1;const e=[];try{f.envs.forEach(t=>{const n=JSON.stringify(JSON.parse(r.value[t.id]));e.push({env_keyword:t.keyword,environment_id:t.id,values:JSON.stringify(JSON.parse(n))})})}catch{return D.error("\u6570\u636E\u683C\u5F0F\u5B58\u5728\u9519\u8BEF"),!1}return _("update",[...e]),!0},h=(o,e)=>{r.value[e]=o};return(o,e)=>{const t=N,n=E,y=b;return i(),m(y,{visible:s.value,"onUpdate:visible":e[0]||(e[0]=a=>s.value=a),title:"\u53D8\u91CF\u503C\u914D\u7F6E",width:"380px",onCancel:e[1]||(e[1]=a=>s.value=!1),onBeforeOk:g},{default:u(()=>[p(n,{ref_key:"formRef",ref:c,model:r.value,"label-align":"left",layout:"vertical","auto-label-width":""},{default:u(()=>[(i(!0),B(x,null,S(d.envs,(a,F)=>(i(),m(t,{key:F,field:String(a.id),label:a.name+"("+a.keyword+")",rules:[{required:!0,message:a.name+"("+a.keyword+")\u914D\u7F6E\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:u(()=>[p(O,{id:String(a.id),value:v.value[a.id],style:{width:"100%",height:"150px"},"show-folding":!1,"show-line":!1,onChange:h},null,8,["id","value"])]),_:2},1032,["field","label","rules"]))),128))]),_:1},8,["model"])]),_:1},8,["visible"])}}});export{A as _};
