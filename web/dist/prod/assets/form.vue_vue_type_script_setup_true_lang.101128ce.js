import"./index.9de08a74.js";/* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               */import{d as U,e as p,w as C,bm as x,bF as q,bD as S,aP as $,bA as I,bo as L,bh as R,aC as g,aI as t,A as B,aJ as l,aL as _,aD as N,bp as T,bE as z}from"./arco.79b3a20c.js";import{p as G}from"./server.cc9bc429.js";const Z=U({__name:"form",props:{data:null,servers:null},emits:["add","update"],setup(w,{expose:D,emit:c}){const f=w,F=p(),d=p(!1),n=p(!1),v=p([]),e=p({...f.data});C(()=>f.data,s=>{e.value=s},{deep:!0}),C(()=>f.servers,s=>{s.forEach(u=>{e.value.servers||(e.value.servers=[]),u.name=`${u.name}(${u.keyword})`,v.value.push(u),e.value.servers.push(u.id)})}),D({showAddDrawer:()=>{d.value=!0,n.value=!0},showUpdateDrawer:()=>{d.value=!0,n.value=!1},closeDrawer:()=>{d.value=!1}});const b=async()=>await F.value.validate()?!1:(n.value?c("add",{...e.value}):c("update",{...e.value}),!0),V=async s=>{const{data:u}=await G({page:1,page_size:10,keyword:s}),{list:i}=u;if(!i)return;e.value.servers||(e.value.servers=[]);const o=[];i.forEach(r=>{e.value.servers.includes(r.id)||(r.name=`${r.name}(${r.keyword})`,o.push(r))});const m=[];v.value.forEach(r=>{e.value.servers.includes(r.id)&&m.push(r)}),v.value=o.concat(m)};return(s,u)=>{const i=x,o=T,m=q,r=S,h=z,E=$,k=I,y=L,A=R;return B(),g(A,{visible:d.value,"onUpdate:visible":u[6]||(u[6]=a=>d.value=a),title:n.value?"\u65B0\u5EFA":"\u4FEE\u6539",width:"380px","unmount-on-close":"",onCancel:u[7]||(u[7]=a=>d.value=!1),onBeforeOk:b},{default:t(()=>[l(y,{ref_key:"formRef",ref:F,model:e.value,"label-align":"left",layout:"horizontal","auto-label-width":""},{default:t(()=>[l(o,{field:"keyword",label:"\u53D8\u91CF\u6807\u8BC6",rules:[{required:!0,message:"\u53D8\u91CF\u6807\u8BC6\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(i,{modelValue:e.value.keyword,"onUpdate:modelValue":u[0]||(u[0]=a=>e.value.keyword=a),disabled:!n.value,placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u6807\u8BC6","allow-clear":""},null,8,["modelValue","disabled"])]),_:1}),l(o,{field:"tag",label:"\u53D8\u91CF\u6807\u7B7E",rules:[{required:!0,message:"\u53D8\u91CF\u6807\u7B7E\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(i,{modelValue:e.value.tag,"onUpdate:modelValue":u[1]||(u[1]=a=>e.value.tag=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u6807\u7B7E","allow-clear":""},null,8,["modelValue"])]),_:1}),l(o,{field:"fieldList",label:"\u53D8\u91CF\u5B57\u6BB5",rules:[{required:!0,message:"\u53D8\u91CF\u5B57\u6BB5\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(m,{modelValue:e.value.fieldList,"onUpdate:modelValue":u[2]||(u[2]=a=>e.value.fieldList=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u5B57\u6BB5","unique-value":"","allow-clear":""},null,8,["modelValue"])]),_:1}),l(o,{field:"private",label:"\u53D8\u91CF\u7C7B\u578B",rules:[{required:!0,message:"\u53D8\u91CF\u7C7B\u578B\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(h,{modelValue:e.value.private,"onUpdate:modelValue":u[3]||(u[3]=a=>e.value.private=a)},{default:t(()=>[l(r,{value:!0},{default:t(()=>[_("\u79C1\u6709\u53D8\u91CF")]),_:1}),l(r,{value:!1},{default:t(()=>[_("\u516C\u5171\u53D8\u91CF")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.value.private?(B(),g(o,{key:0,field:"private",label:"\u6240\u5C5E\u670D\u52A1",rules:[{required:!0,message:"\u6240\u5C5E\u670D\u52A1\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(E,{modelValue:e.value.servers,"onUpdate:modelValue":u[4]||(u[4]=a=>e.value.servers=a),placeholder:"\u8BF7\u9009\u62E9\u53D8\u91CF\u6240\u5C5E\u670D\u52A1",multiple:"","max-tag-count":2,scrollbar:!0,options:v.value,"allow-search":"","field-names":{value:"id",label:"name"},onSearch:V},null,8,["modelValue","options"])]),_:1})):N("",!0),l(o,{field:"description",label:"\u53D8\u91CF\u63CF\u8FF0",rules:[{required:!0,message:"\u53D8\u91CF\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:t(()=>[l(k,{modelValue:e.value.description,"onUpdate:modelValue":u[5]||(u[5]=a=>e.value.description=a),placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}});export{Z as _};
